(this["webpackJsonpnotion-timeline-widget"]=this["webpackJsonpnotion-timeline-widget"]||[]).push([[0],{17:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(7),c=n.n(r),i=n(4),s=n(5),u=n(8),d=n.n(u),p=(n(17),n(1)),l=864e5,m=86399999,h={default:"#505558",gray:"#6b6f71",brown:"#695c55",orange:"#917448",yellow:"#9f904d",green:"#487871",blue:"#497088",purple:"#6d5a90",pink:"#924d75",red:"#a05d59"};function f(){var e=Object(o.useState)([]),t=Object(s.a)(e,2),n=t[0],a=t[1],r=new URLSearchParams(window.location.search),c=r.get("database_id")||"",u=r.get("token")||"";Object(o.useEffect)((function(){fetch("".concat("https://vr-cors-everywhere.herokuapp.com","/https://api.notion.com/v1/databases/").concat(c,"/query"),{method:"POST",headers:{Authorization:"Bearer ".concat(u),"Notion-Version":"2021-08-16"}}).then((function(e){return e.json()})).then((function(e){return a(e.results)}))}),[c,u]);var f=Object(o.useMemo)((function(){return n.map((function(e){var t=e.properties.Scope.multi_select.map((function(e){return{name:e.name,color:e.color}}));return t.map((function(n){var o,a;return{scope:n,scopes:t,name:e.properties.Name.title[0].text.content,startDate:e.properties.Date.date.start,endDate:e.properties.Date.date.end,ongoing:null!==(o=null===(a=e.properties.Ongoing)||void 0===a?void 0:a.checkbox)&&void 0!==o&&o}}))})).flat()}),[n]),b=Object(o.useMemo)((function(){return Object(i.a)(new Set(f.map((function(e){return{name:e.scope.name,color:e.scope.color}}))))}),[f]),g=Object(o.useMemo)((function(){return f.map((function(e){return{name:"".concat(e.name," (").concat(e.scopes.map((function(e){return e.name})).join(", "),")"),data:[{x:e.scope.name,y:[Date.parse(e.startDate),e.ongoing?Date.now()+m:e.endDate?Date.parse(e.endDate)+m:Date.parse(e.startDate)+m]}]}}))}),[f]),j=Object(o.useMemo)((function(){return[Math.min.apply(Math,Object(i.a)(g.map((function(e){return e.data[0].y[0]}))))||Date.now()-l,Math.max.apply(Math,Object(i.a)(g.map((function(e){return e.data[0].y[1]}))))||Date.now()+l]}),[g]),w=Object(s.a)(j,2),O=w[0],y=w[1],v=(y-O)/100;return c&&u?Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(d.a,{type:"rangeBar",width:"100%",height:"100%",options:{chart:{toolbar:{offsetX:"-100%",tools:{download:!1,selection:!0,zoom:!0,zoomin:!0,zoomout:!0,pan:!0,customIcons:[{icon:'<img src="'.concat("/notion-timeline-widget",'/reload.svg" width="16">'),class:"custom-icon",index:0,title:"Reload",click:function(){return window.location.reload()}},{icon:'<img src="'.concat("/notion-timeline-widget",'/copy.svg" width="16">'),class:"custom-icon copy-url",index:0,title:"Copy URL",click:function(){}}]}}},plotOptions:{bar:{horizontal:!0}},dataLabels:{enabled:!0,formatter:function(e,t){var n=Object(s.a)(e,2),o=n[0],a=n[1],r=Math.ceil((a-o)/l),c=r+(r>1?" days":" day"),i=g[t.seriesIndex];return i?"".concat(i.name,": ").concat(c):c}},colors:b.map((function(e){return h[e.color]})),theme:{palette:"palette1",mode:"dark"},xaxis:{type:"datetime",min:O-v,max:y+v},legend:{show:!1},stroke:{width:5}},series:g})}):Object(p.jsx)("div",{children:"Database ID and/or Notion token is not provided"})}c.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(f,{})}),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.9d3bd23b.chunk.js.map